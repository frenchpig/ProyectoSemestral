{% extends "./base.html" %}
{% load static %}


{% block header %}
  <link rel="stylesheet" href="{% static 'css/styles.css'%}">
  
{% endblock %}

{% block body %}

  <!-- Control de Stock -->
  <div class="container mt-2">
    <!-- Modal -->
    <div class="modal fade" id="modalConfirmacion" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Eliminar Producto</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            Â¿Seguro que quieres eliminar este producto?
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            <button type="button" class="btn btn-danger">Eliminar</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Fin Modal -->
    <!-- Titulo de la seccion -->
    <div class="row text-center">
      <p class="fs-1">
        Stock de Productos
      </p>
    </div>

    <!-- Agregar Productos -->
    <div class="row">
      <h3>Agregar Producto</h3>
    </div>
    <form action="{% url 'agregar_productos' %}" id="formAgregarProductos" class="row d-flex justify-content-center needs-validation" method="POST" enctype="multipart/form-data" novalidate> {% csrf_token %}
      <div class="col-md-3 col-sm-2">
        <label for="prodNombre">Nombre:</label>
        <input type="text" class="form-control" id="prodNombre" placeholder="Ingrese nombre del producto..." maxlength="44" required name="prodNombre">
        <div class="invalid-feedback">
          Porfavor ingrese nombre de producto.
        </div>
      </div>
      <div class="col-md-3">
        <label for="prodPrecio">Precio:</label>
        <input type="number" class="form-control" id="prodPrecio" required name="prodPrecio">
        <div class="invalid-feedback">
          Porfavor ingrese precio de producto.
        </div>
      </div>
      <div class="col-md-3">
        <label for="prodCantidad">Cantidad en Stock:</label>
        <input type="number" class="form-control" id="prodCantidad" required name="prodCantidad">
        <div class="invalid-feedback">
          Porfavor ingrese cantidad en stock de producto.
        </div>
      </div>
      <div class="col-md-3">
        <label for="prodCategoria">Categoria: </label>
        <select id="prodCategoria" class="form-select" aria-label="Default select example" name="prodCategoria">
          <option value="0" selected disabled>Seleccionar...</option>
          {% for c in cates %}
            <option value="{{c.categoria_id}}">{{c.nombre}}</option>
          {% endfor %}
        </select>
        <div class="invalid-feedback">
          Porfavor seleccione una categoria.
        </div>
      </div>
      <div class="col-md-12">
        <label for="prodDescripcion">Descripcion: </label>
        <input type="text" class="form-control" id="prodDescripcion"
          placeholder="Ingrese la descripcion del producto..." maxlength="115" required name="prodDescripcion">
        <div class="invalid-feedback">
          Porfavor ingrese descripcion de producto.
        </div>
      </div>
      <div class="col-md-12">
        <label for="prodImagen">Imagen: </label>
        <input type="file" accept="image/*" class="form-control" id="prodImagen" placeholder="Ingrese la URL de la imagen del producto..." required name="prodImagen">
        <div class="invalid-feedback">
          Porfavor ingrese imagen de producto con el formato .jpg, .jpeg o .png
        </div>
      </div>
      <button id="botonAgregar" type="submit" class="btn btn-verde mt-3 w-75">Agregar</button>
    </form>
  </div>
  <!-- Fin Agregar Productor -->

  <!-- Productos disponibles + buscador -->
  <div class="row d-flex justify-content-center mt-3">
    <div class="col-6">
      <div class="input-group mb-3">
        <input id="txtBuscar" type="text" class="form-control" placeholder="Buscar..."
          aria-describedby="btnEliminarStorage">
        <button class="btn btn-azul" type="button" id="btnBuscar"><i class="bi bi-search"></i></button>
      </div>
    </div>
  </div>

  <div class="row d-flex justify-content-center">
    <div class="col-8">
      <table id="tabla" class="table mb-5">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Producto</th>
            <th scope="col">Precio</th>
            <th scope="col">Stock</th>
            <th scope="col">Categoria</th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody id="cuerpoTabla">
          {% for p in prod %}
          <tr>
            <td scope="row">{{p.sku}}</td>
            <td>{{p.nombre}}</td>
            <td>{{p.precio}}</td>
            <td>{{p.stock}}</td>
            <td>{{p.categoria_id.nombre}}</td>
            <td>
              <a href="/edit/{{p.sku}}" class="btn btn-azul my-1"><i class="bi bi-pencil-square"></i></a>
              <a id="btnEliminar" href="/delete/{{p.sku}}" class="btn btn-rojo my-1"><i class="bi bi-trash3-fill"></i></a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  <!-- Fin Productos disponibles + buscador -->
{% endblock %}

{% block script %}
  <script src="{% static 'js/stock.js'%}"></script>
{% endblock %}